<ol class="breadcrumb">
  <li>Messages</li>
  <li class="active">Viewing: <%= @message.subject %></li>
</ol>

<div class="row">
	<div class="col-md-8">
				<table class="table table-striped table-bordered">
					<tr>
						<td>
							<dl class="dl-horizontal">
							  <dt>Date</dt>
							  <dd><%= @message.created_at.strftime("%A, %B %d, %Y at %l:%M %p") %></dd>
							  <dt>Subject</dt>
							  <dd>
									<% if @message.classification %>
									  <%= @message.classification.short_description %>
									<% end %>
									<% if @message.modifier %>
									  <%= @message.modifier.short_description %>
									<% end %>
								  <%= @message.subject %>
								</dd>
							  <dt>Summary</dt>
							  <dd><%= @message.impact_statement %></dd>
							<% if @message.window_start %>
							  <dt>Start of window</dt>
							  <dd><%= @message.window_start.strftime("%A, %B %d, %Y at %l:%M %p") %></dd>
							<% end %>
							<% if @message.window_end %>
							  <dt>End of window</dt>
							  <dd><%= @message.window_end.strftime("%A, %B %d, %Y at %l:%M %p") %></dd>
							<% end %>
							<% if @message.purpose %>
							  <dt>Purpose</dt>
							  <dd><%= @message.purpose %></dd>
							<% end %>
							<% if @message.resolution %>
							  <dt>Resolution</dt>
							  <dd><%= @message.resolution %></dd>
							<% end %>
							<% if @message.workaround %>
							  <dt>Workaround</dt>
							  <dd><%= @message.workaround %></dd>
							<% end %>
							<% if @message.other_services %>
							  <dt>Other Services</dt>
							  <dd><%= @message.other_services %></dd>
							<% end %>
							<% if @message.impacted_services.length > 0 %>
							  <dt>Impacted Services</dt>
							  <dd>
									<% @message.impacted_services.each do |is| %>
										<li><%= is.name %></li>
									<% end %>
								</dd>
							<% end %>
							</dl>
						</td>
					</tr>
				</table>

	</div>
	<div class="col-md-4">
		<div id="send_status" style="min-width: 300px; height: 300px; max-width: 300px; margin: 0 auto"></div>

		<div id="read_status" style="min-width: 300px; height: 300px; max-width: 300px; margin: 0 auto"></div>
	</div>
</div> <!-- .row -->

<script type="text/javascript">
	ready = function() {
		// Make monochrome colors and set them as default for all pies
    Highcharts.getOptions().plotOptions.pie.colors = (function () {
        var colors = [];

				colors[0] = '#377bb5';
				colors[1] = '#60c0dc';
				colors[2] = '#d75452';

        return colors;
    }());

    // Build the charts
    $('#read_status').highcharts({
        chart: {
            plotBackgroundColor: null,
            plotBorderWidth: null,
            plotShadow: false,
            type: 'pie'
        },
        title: {
            text: 'Read Status'
        },
        tooltip: {
            pointFormat: '{series.name}: <b>{point.percentage:.1f}%</b>'
        },
        plotOptions: {
            pie: {
                allowPointSelect: false,
                cursor: 'pointer',
								dataLabels: {
                  enabled: false
                },
                showInLegend: true
            }
        },
        series: [{
            name: "Statuses",
            data: [
                {name: "Read", y: 56.33},
                {name: "Unread / Unknown", y: 10.38}
            ]
        }]
    });

    $('#send_status').highcharts({
        chart: {
            plotBackgroundColor: null,
            plotBorderWidth: null,
            plotShadow: false,
            type: 'pie'
        },
        title: {
            text: 'Send Status'
        },
        tooltip: {
            pointFormat: '{series.name}: <b>{point.percentage:.1f}%</b>'
        },
        plotOptions: {
            pie: {
                allowPointSelect: false,
                cursor: 'pointer',
								dataLabels: {
                  enabled: false
                },
                showInLegend: true
            }
        },
        series: [{
            name: "Statuses",
            data: [
                {name: "Delivered", y: 56.33},
                {name: "Sending", y: 24.03},
                {name: "Failed", y: 10.38}
            ]
        }]
    });
	};

	$(document).on('ready page:load', ready);
</script>
